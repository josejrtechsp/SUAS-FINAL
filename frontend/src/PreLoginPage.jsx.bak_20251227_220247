import React, { useMemo, useState } from "react";
import IdealAreas from "./components/IdealAreas.jsx";
import { Link } from "react-router-dom";

import { IDEAL_SERVICES } from "./content/idealServices.js";
import "./Portal.css";

function goAtualizacoes(q) {
  const query = (q || "").trim();
  const url = query ? `/atualizacoes?q=${encodeURIComponent(query)}` : "/atualizacoes";
  window.location.assign(url);
}

export default function PreLoginPage({ onEntrar }) {
  const [busca, setBusca] = useState("");

  const chips = useMemo(
    () => [
      "LGPD por perfil",
      "Trilha de auditoria",
      "Fluxo por etapas",
      "SLA e pendÃªncias",
      "Rede e consÃ³rcio",
      "Dashboards",
      "Pesquisa e diagnÃ³stico",
    ],
    []
  );

  const audiencias = useMemo(
    () => [
      {
        icon: "ğŸ›ï¸",
        title: "Prefeituras",
        text:
          "Organize execuÃ§Ã£o por fluxo, padronize registros, reduza retrabalho e gere evidÃªncias para auditoria, prestaÃ§Ã£o de contas e controle social.",
      },
      {
        icon: "ğŸŒ",
        title: "ConsÃ³rcios",
        text:
          "OperaÃ§Ã£o regional com padrÃµes, indicadores comparÃ¡veis e cooperaÃ§Ã£o entre municÃ­pios â€” mantendo LGPD, rastreabilidade e governanÃ§a.",
      },
      {
        icon: "ğŸ¢",
        title: "Empresas",
        text:
          "Pesquisa de mercado e inteligÃªncia para decisÃ£o: posicionamento, satisfaÃ§Ã£o, hÃ¡bitos e oportunidades reais para investir melhor.",
      },
      {
        icon: "ğŸ—³ï¸",
        title: "Campanhas",
        text:
          "Pesquisa eleitoral e tracking com leitura territorial e segmentaÃ§Ã£o: menos achismo, mais estratÃ©gia e comunicaÃ§Ã£o testada.",
      },
    ],
    []
  );

  const modulos = useMemo(
    () => [
      { id: "cras", icon: "ğŸ ", title: "CRAS", text: "Triagem, acompanhamento familiar e encaminhamentos com padrÃ£o." },
      { id: "creas", icon: "ğŸ§¾", title: "CREAS", text: "Casos complexos com etapas, prazos e contexto preservado." },
      { id: "poprua", icon: "ğŸš¶â€â™€ï¸", title: "Pop Rua", text: "Abordagem, busca ativa e gestÃ£o de caso com rastreabilidade." },
      { id: "acolhimentos", icon: "ğŸ›ï¸", title: "Acolhimentos", text: "Vagas, entradas/saÃ­das, acompanhamento e relatÃ³rios claros." },
      { id: "gestao", icon: "ğŸ¯", title: "GestÃ£o", text: "Painel do municÃ­pio: gargalos, produtividade e indicadores." },
      { id: "terceiro_setor", icon: "ğŸ¤", title: "Terceiro Setor", text: "Parcerias/OSCs: execuÃ§Ã£o, documentos e prestaÃ§Ã£o de contas." },
      { id: "vigilancia", icon: "ğŸ—ºï¸", title: "VigilÃ¢ncia", text: "Indicadores e visÃ£o territorial para priorizaÃ§Ã£o e evidÃªncias." },
      { id: "conselho", icon: "ğŸ›ï¸", title: "Conselho", text: "CMAS: evidÃªncias e relatÃ³rios com trilha de auditoria." },
    ],
    []
  );

  return (
    <div className="portal3-root">
      <header className="portal3-topbar">
        <div className="portal3-topbar-inner">
          <div className="portal3-brandRow">
            <img className="portal3-logo" src="/ideal-logo.png" alt="IDEAL" />
            <div className="portal3-brand">
              <div className="portal3-brand-tag">IDEAL Â· INTELIGÃŠNCIA PÃšBLICA E DE MERCADO</div>
              <div className="portal3-brand-title">
                Plataforma Municipal <span className="portal3-brand-highlight">Integrada</span>
              </div>
              <div className="portal3-brand-sub">GovTech â€¢ Pesquisa â€¢ DiagnÃ³stico â€¢ Monitoramento â€¢ ExecuÃ§Ã£o</div>
            </div>
          </div>

          <div className="portal3-actions">
            <input
              className="portal3-search"
              value={busca}
              onChange={(e) => setBusca(e.target.value)}
              onKeyDown={(e) => e.key === "Enter" && goAtualizacoes(busca)}
              placeholder="Buscar no portal (MDS, CNAS, FNAS, TipificaÃ§Ã£o, NOB SUAS, CadÃšnico, RMA...)"
            />
            <button type="button" className="portal3-btn-secondary" onClick={() => goAtualizacoes(busca)}>
              AtualizaÃ§Ãµes oficiais
            </button>
            <button type="button" className="portal3-btn-primary" onClick={() => onEntrar?.()}>
              Acessar o painel
            </button>
          </div>
        </div>
      </header>

      <section className="portal3-hero">
        <div className="portal3-hero-inner">
          <div>
            <div className="portal3-kicker">
              SUAS â€¢ SaÃºde â€¢ EducaÃ§Ã£o â€¢ ConsÃ³rcios â€¢ Empresas â€¢ Campanhas â€¢ Portal de referÃªncias
            </div>

            <h1 className="portal3-title">
              Do diagnÃ³stico Ã  execuÃ§Ã£o: <span className="portal3-highlight">governanÃ§a de dados</span> e software para
              entregar resultado.
            </h1>

            <p className="portal3-lead">
              A IDEAL conecta <b>pesquisa e inteligÃªncia</b>, <b>planejamento e diagnÃ³stico</b>, <b>governanÃ§a e execuÃ§Ã£o</b>
              e <b>tecnologia</b> â€” com fluxos, SLAs, rastreabilidade e indicadores.
            </p>

            <div className="portal3-cta-row">
              <button type="button" className="portal3-btn-primary portal3-btn-big" onClick={() => onEntrar?.()}>
                Entrar no sistema
              </button>
              <a className="portal3-link" href="#servicos">
                Ver serviÃ§os â†“
              </a>
              <a className="portal3-link" href="#modulos">
                Ver mÃ³dulos â†“
              </a>
              <a className="portal3-link" href="/atualizacoes">
                AtualizaÃ§Ãµes â†’
              </a>
            </div>

            <div className="portal3-chips">
              {chips.map((c) => (
                <span key={c} className="portal3-chip">
                  {c}
                </span>
              ))}
            </div>
          </div>

          <div className="portal3-feature">
            <div className="portal3-feature-title">O que vocÃª ganha</div>
            <ul className="portal3-bullets">
              <li>PadronizaÃ§Ã£o (fim do â€œcada um faz do seu jeitoâ€).</li>
              <li>PendÃªncias, etapas e responsÃ¡veis visÃ­veis (SLA).</li>
              <li>HistÃ³rico contÃ­nuo + trilha de auditoria (evidÃªncias).</li>
              <li>Indicadores para gestÃ£o, controle social e prestaÃ§Ã£o de contas.</li>
              <li>OperaÃ§Ã£o em rede e visÃ£o regional (consÃ³rcios).</li>
            </ul>
            <button type="button" className="portal3-btn-secondary" onClick={() => onEntrar?.()}>
              Escolher mÃ³dulo (login)
            </button>
          </div>
        </div>
      </section>

      <main className="portal3-main">
      <IdealAreas />
    </main>
    </div>
  );
}
