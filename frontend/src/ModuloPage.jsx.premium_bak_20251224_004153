import React, { useMemo } from "react";
import { useParams } from "react-router-dom";
import "./Portal.css";

const MODULOS = {
  cras: {
    titulo: "CRAS (PAIF / SCFV / encaminhamentos)",
    resumo: "Padronize triagem, acompanhamento familiar e encaminhamentos com LGPD aplicada por perfil.",
    resolve: [
      "Evita 'cada um registra de um jeito' e reduz retrabalho.",
      "Mant√©m hist√≥rico cont√≠nuo da fam√≠lia/usu√°rio e do plano de acompanhamento.",
      "Organiza encaminhamentos e devolutivas com responsabilidade por etapa.",
      "Apoia indicadores e relat√≥rios com rastreabilidade.",
    ],
    comoAjuda: [
      "Triagem guiada e registro padronizado",
      "Acompanhamento familiar (PAIF) e atividades (SCFV) com hist√≥rico",
      "Encaminhamentos com status (enviado ‚Üí recebido ‚Üí devolutiva)",
      "Checklist por etapa (modelo do Guia SUAS)",
    ],
    indicadores: [
      "Atendimentos por unidade/equipe/per√≠odo",
      "Fam√≠lias acompanhadas, tempo de resposta, pend√™ncias",
      "Encaminhamentos sem devolutiva e gargalos",
    ],
  },
  creas: {
    titulo: "CREAS (PAEFI / viola√ß√µes / medidas)",
    resumo: "Casos complexos com etapas, prazos e contexto preservado ‚Äî com sigilo e auditoria.",
    resolve: [
      "Evita perda de contexto em casos complexos (hist√≥rico por etapa).",
      "Organiza prazos, pend√™ncias e responsabilidades.",
      "D√° seguran√ßa institucional com LGPD, rastreabilidade e auditoria.",
      "Gera evid√™ncia para relat√≥rios e presta√ß√£o de contas.",
    ],
    comoAjuda: [
      "Fluxo por etapas com valida√ß√£o e motivo de travamento",
      "Pend√™ncias e prazos (alertas) por caso",
      "Registro estruturado + anexos/evid√™ncias",
      "Relat√≥rios e exporta√ß√µes com mascaramento (quando necess√°rio)",
    ],
    indicadores: [
      "Casos por etapa e tempo m√©dio em cada etapa",
      "Pend√™ncias em aberto e reincid√™ncia",
      "Produtividade por equipe e gargalos",
    ],
  },
  poprua: {
    titulo: "Pop Rua (abordagem, busca ativa e rede)",
    resumo: "Gest√£o de caso e opera√ß√£o de rua com rastreabilidade por etapa e controle de exposi√ß√£o (LGPD).",
    resolve: [
      "Registro r√°pido na rua + hist√≥rico completo do caso.",
      "Linha do tempo por etapas com evid√™ncias e respons√°veis.",
      "Integra√ß√£o por fluxo (encaminhamento/devolutiva) com exposi√ß√£o m√≠nima.",
      "Gest√£o enxerga gargalos, recorr√™ncia e tempos de resposta.",
    ],
    comoAjuda: [
      "Abordagem r√°pida e atendimento completo",
      "Linha do Metr√¥ (etapas clic√°veis) com hist√≥rico imut√°vel",
      "Encaminhamentos intersetoriais com status e devolutiva",
      "Painel operacional (fila, pend√™ncias, prazos) e painel gestor",
    ],
    indicadores: [
      "Abordagens/atendimentos por per√≠odo e territ√≥rio",
      "Recorr√™ncia e tempo de resposta",
      "Desfechos por etapa e status",
    ],
  },
  acolhimentos: {
    titulo: "Acolhimentos (unidades, vagas e movimenta√ß√µes)",
    resumo: "Controle de vagas, entradas/sa√≠das e acompanhamento ‚Äî com relat√≥rios claros para gest√£o e rede.",
    resolve: [
      "Organiza entradas/sa√≠das, hist√≥rico e motivo de movimenta√ß√µes.",
      "Evita duplicidade e perda de informa√ß√£o entre unidades.",
      "Apoia gest√£o com relat√≥rios por tipo de vaga, tempo de perman√™ncia e rotatividade.",
    ],
    comoAjuda: [
      "Registro de acolhimento (entrada) e encerramento (sa√≠da) com motivo e destino",
      "V√≠nculo com caso e hist√≥rico do usu√°rio",
      "Relat√≥rios por unidade/tipo de vaga/per√≠odo",
      "Integra√ß√£o por fluxo com encaminhamentos e devolutivas",
    ],
    indicadores: [
      "Taxa de ocupa√ß√£o (por unidade/tipo de vaga)",
      "Tempo m√©dio de perman√™ncia",
      "Entradas/sa√≠das por per√≠odo e causas",
    ],
  },
  gestao: {
    titulo: "Gest√£o e Coordena√ß√£o (painel do munic√≠pio)",
    resumo: "Governan√ßa da rede: gargalos, produtividade, tempos por etapa e indicadores por unidade/territ√≥rio.",
    resolve: [
      "Gestor enxerga gargalos e filas em tempo real.",
      "Padroniza evid√™ncias para auditoria e presta√ß√£o de contas.",
      "Compara unidades/equipes e evolu√ß√£o mensal.",
    ],
    comoAjuda: [
      "Dashboard: volumetria, status e produtividade",
      "Alertas de prazo/estagna√ß√£o (casos sem atualiza√ß√£o)",
      "Relat√≥rios gerenciais (anonimizados quando necess√°rio)",
      "Vis√£o cons√≥rcio (comparativos intermunicipais ‚Äî quando habilitado)",
    ],
    indicadores: [
      "Casos por etapa/status (em andamento/encerrados/arquivados)",
      "Tempo m√©dio por etapa",
      "Produtividade por equipe/unidade",
    ],
  },
  vigilancia: {
    titulo: "Vigil√¢ncia Socioassistencial (territ√≥rio e evid√™ncias)",
    resumo: "Indicadores e leitura territorial para priorizar a√ß√µes e justificar aloca√ß√£o de recursos.",
    resolve: [
      "Mostra concentra√ß√£o de demanda e vazios assistenciais.",
      "Ajuda prioriza√ß√£o e planejamento com evid√™ncias.",
      "Apoia presta√ß√£o de contas com indicadores claros.",
    ],
    comoAjuda: [
      "Indicadores por territ√≥rio/per√≠odo/p√∫blico",
      "S√©ries hist√≥ricas e comparativos",
      "Exporta√ß√µes para relat√≥rios e reuni√µes",
      "Base para mapa/heatmap (opcional)",
    ],
    indicadores: [
      "Incid√™ncia por territ√≥rio",
      "Recorr√™ncia e tempo de resposta",
      "Evolu√ß√£o mensal por servi√ßo",
    ],
  },
  terceiro_setor: {
    titulo: "Terceiro Setor (parcerias e presta√ß√£o de contas)",
    resumo: "Organize execu√ß√£o, documentos e presta√ß√£o de contas das OSCs com transpar√™ncia e rastreabilidade.",
    resolve: [
      "Centraliza documentos e evid√™ncias por parceria.",
      "Facilita an√°lise e acompanhamento pela gest√£o.",
      "Apoia transpar√™ncia e controle social sem expor dados pessoais.",
    ],
    comoAjuda: [
      "Cadastro de parcerias/OSCs e rotinas",
      "Upload de documentos e trilha de evid√™ncias",
      "Relat√≥rios por parceria/per√≠odo",
      "Acesso por perfil (LGPD) e auditoria",
    ],
    indicadores: [
      "Execu√ß√£o por parceria e per√≠odo",
      "Pend√™ncias documentais",
      "Entregas/atividades registradas",
    ],
  },
  conselho: {
    titulo: "Conselho (CMAS e controle social)",
    resumo: "Acesso orientado √† informa√ß√£o certa: relat√≥rios, metas e evid√™ncias com trilha de auditoria.",
    resolve: [
      "Facilita delibera√ß√£o com informa√ß√£o objetiva e rastre√°vel.",
      "Apoia fiscaliza√ß√£o sem expor dados sens√≠veis.",
      "Organiza relat√≥rios e evid√™ncias por per√≠odo.",
    ],
    comoAjuda: [
      "Relat√≥rios e exporta√ß√µes com mascaramento/anonimiza√ß√£o quando necess√°rio",
      "Indicadores de execu√ß√£o e monitoramento",
      "Trilha de auditoria (quem gerou/visualizou/exportou)",
      "Biblioteca do Guia SUAS para padroniza√ß√£o",
    ],
    indicadores: [
      "Relat√≥rios por per√≠odo e servi√ßo",
      "Evid√™ncias anexas e trilhas",
      "S√©ries de acompanhamento (metas/execu√ß√£o)",
    ],
  },
};

export default function ModuloPage({ onEntrar }) {
  const { id } = useParams();
  const mod = MODULOS[(id || "").toLowerCase()];

  if (!mod) {
    return (
      <div className="portal3-root">
        <header className="portal3-topbar">
          <div className="portal3-topbar-inner">
            <div className="portal3-brand">
              <div className="portal3-brand-tag">M√ìDULO ¬∑ Inteligencia Social</div>
              <div className="portal3-brand-title">
                Portal <span className="portal3-brand-highlight">SUAS</span>
              </div>
              <div className="portal3-brand-sub">M√≥dulo n√£o encontrado.</div>
            </div>
            <div className="portal3-actions">
              <button type="button" className="portal3-btn-secondary" onClick={() => (window.location.href = "/")}>
                ‚Üê Portal
              </button>
              <button type="button" className="portal3-btn-primary" onClick={() => onEntrar?.()}>
                Acessar o painel
              </button>
            </div>
          </div>
        </header>

        <main className="portal3-main">
          <section className="portal3-section">
            <div className="portal3-empty">M√≥dulo inv√°lido: ‚Äú{id}‚Äù.</div>
          </section>
        </main>
      </div>
    );
  }

  return (
    <div className="portal3-root">
      <header className="portal3-topbar">
        <div className="portal3-topbar-inner">
          <div className="portal3-brand">
            <div className="portal3-brand-tag">M√ìDULO ¬∑ Inteligencia Social</div>
            <div className="portal3-brand-title">
              {mod.titulo.split(" ")[0]} <span className="portal3-brand-highlight">SUAS</span>
            </div>
            <div className="portal3-brand-sub">{mod.resumo}</div>
          </div>

          <div className="portal3-actions">
            <button type="button" className="portal3-btn-secondary" onClick={() => (window.location.href = "/#modulos")}>
              ‚Üê Portal
            </button>
            <button type="button" className="portal3-btn-primary" onClick={() => onEntrar?.()}>
              Acessar o painel
            </button>
          </div>
        </div>
      </header>

      <section className="portal3-hero">
        <div className="portal3-hero-inner">
          <div>
            <div className="portal3-kicker">M√≥dulo do Sistema SUAS</div>
            <h1 className="portal3-title">
              {mod.titulo}
            </h1>
            <p className="portal3-lead">{mod.resumo}</p>

            <div className="portal3-cta-row">
              <button type="button" className="portal3-btn-primary portal3-btn-big" onClick={() => onEntrar?.()}>
                Ver no painel (login)
              </button>
              <a className="portal3-link" href="#como">Como o sistema ajuda ‚Üì</a>
              <a className="portal3-link" href="#indicadores">Indicadores ‚Üì</a>
            </div>

            <div className="portal3-chips">
              <span className="portal3-chip">LGPD por perfil</span>
              <span className="portal3-chip">Rastreabilidade</span>
              <span className="portal3-chip">Fluxo por etapas</span>
              <span className="portal3-chip">Evid√™ncias e relat√≥rios</span>
            </div>
          </div>

          <div className="portal3-feature">
            <div className="portal3-feature-title">O que esse m√≥dulo resolve?</div>
            <ul className="portal3-bullets">
              {mod.resolve.map((t, i) => <li key={i}>{t}</li>)}
            </ul>
            <button type="button" className="portal3-btn-secondary" onClick={() => (window.location.href = "/#guia")}>
              Abrir Guia SUAS (no portal)
            </button>
          </div>
        </div>
      </section>

      <main className="portal3-main">
        <section className="portal3-section" id="como">
          <div className="portal3-section-head">
            <h2 className="portal3-h2">Como o sistema pode ajudar</h2>
            <p className="portal3-sub">Funcionalidades pr√°ticas que reduzem retrabalho e aumentam padr√£o na rede.</p>
          </div>

          <div className="portal3-cards-3">
            {mod.comoAjuda.map((t, i) => (
              <div key={i} className="portal3-card">
                <div className="portal3-card-icon">‚úÖ</div>
                <div className="portal3-card-title">{t}</div>
                <div className="portal3-card-text">Implementa√ß√£o orientada por rotinas do servi√ßo e boas pr√°ticas do Guia SUAS.</div>
              </div>
            ))}
          </div>
        </section>

        <section className="portal3-section" id="indicadores">
          <div className="portal3-section-head">
            <h2 className="portal3-h2">Indicadores e evid√™ncias</h2>
            <p className="portal3-sub">O gestor enxerga gargalos, filas e resultados ‚Äî com rastreabilidade.</p>
          </div>

          <div className="portal3-cards-3">
            {mod.indicadores.map((t, i) => (
              <div key={i} className="portal3-card">
                <div className="portal3-card-icon">üìä</div>
                <div className="portal3-card-title">{t}</div>
                <div className="portal3-card-text">Relat√≥rios e exporta√ß√µes com controle de exposi√ß√£o (LGPD) quando necess√°rio.</div>
              </div>
            ))}
          </div>

          <div className="portal3-cta-strip">
            <div className="portal3-cta-strip-text">
              Quer ver isso funcionando no seu munic√≠pio? Comece por este m√≥dulo e evolua para o SUAS completo.
            </div>
            <button type="button" className="portal3-btn-primary" onClick={() => onEntrar?.()}>
              Acessar o painel
            </button>
          </div>
        </section>

        <footer className="portal3-footer">
          <div className="portal3-footer-inner">
            <span><strong>Portal SUAS</strong> ‚Ä¢ Inteligencia Social</span>
            <span className="portal3-footer-muted">P√°gina do m√≥dulo: /modulos/{id}</span>
          </div>
        </footer>
      </main>
    </div>
  );
}
